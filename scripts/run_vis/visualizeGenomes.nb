(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     17041,        456]
NotebookOptionsPosition[     15923,        414]
NotebookOutlinePosition[     16279,        430]
CellTagsIndexPosition[     16236,        427]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["BSF History", "Section",
 CellChangeTimes->{{3.517567543254239*^9, 3.517567551045595*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"genomes", "=", 
   RowBox[{"ToExpression", "@", 
    RowBox[{"StringSplit", "[", 
     RowBox[{
      RowBox[{
      "Import", "[", "\"\<~/java/exp/GP_T/run_001_010_O_GENOMES_MATH.txt\>\"",
        "]"}], ",", "\"\<\\n\>\""}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.517567581714533*^9, 3.517567643469067*^9}, 
   3.5175678741298027`*^9, {3.517583385708066*^9, 3.51758339640762*^9}, 
   3.517585509025359*^9, {3.517590506722928*^9, 3.517590507730856*^9}}],

Cell["\<\
Finds the genome id of the BSF. Warning it searches only the last generation!\
\
\>", "Text",
 CellChangeTimes->{{3.517587941481865*^9, 3.517587969917118*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Flatten", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", 
       RowBox[{"{", 
        RowBox[{"b", ",", "e"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c", ",", 
       RowBox[{"{", 
        RowBox[{"d", ",", "f"}], "}"}]}], "}"}]}], "}"}], ",", "1"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.517590362889983*^9, 3.5175904390650463`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"a", ",", 
   RowBox[{"{", 
    RowBox[{"b", ",", "e"}], "}"}], ",", "c", ",", 
   RowBox[{"{", 
    RowBox[{"d", ",", "f"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.51759035512403*^9, 3.517590364820951*^9}, {
   3.5175904099572697`*^9, 3.517590440012713*^9}, 3.5175905234782677`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"findBSFId", "[", "genomes_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Sort", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"genomes", ",", "1"}], "]"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"#1", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], 
       ">", 
       RowBox[{"#2", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}],
       "&"}]}], "]"}], "\[LeftDoubleBracket]", 
   RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5175874934665213`*^9, 3.517587493725911*^9}, {
  3.517587593522855*^9, 3.517587652979639*^9}, {3.517587691077076*^9, 
  3.517587763579756*^9}, {3.517590453418391*^9, 3.5175904671379137`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"findBSFId", "[", "genomes", "]"}]], "Input",
 CellChangeTimes->{{3.517587742406143*^9, 3.517587767266717*^9}}],

Cell[BoxData["998633"], "Output",
 CellChangeTimes->{{3.517587749966003*^9, 3.5175877678162327`*^9}, 
   3.5175891153335457`*^9, 3.517590471950859*^9, 3.517590531083343*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"traceBackIds", "[", 
   RowBox[{"parentId_Integer", ",", "genomes_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"p", ",", "n", ",", "i", ",", 
      RowBox[{"l", "=", 
       RowBox[{"{", "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"n", "=", "parentId"}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", 
        RowBox[{"Length", "[", "genomes", "]"}]}], ",", 
       RowBox[{"i", "\[GreaterEqual]", "1"}], ",", 
       RowBox[{"i", "--"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"p", "=", 
         RowBox[{"Cases", "[", 
          RowBox[{
           RowBox[{
           "genomes", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "_", ",", "_", ",", "_"}], "}"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"p", "=!=", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{
           RowBox[{"p", "=", 
            RowBox[{"Sequence", "@@", "p"}]}], ";", 
           RowBox[{"PrependTo", "[", 
            RowBox[{"l", ",", "p"}], "]"}], ";", 
           RowBox[{"n", "=", 
            RowBox[{
            "p", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
           ";"}], ",", "Null"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
      ";", "\[IndentingNewLine]", "l"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.517568657050269*^9, 3.5175687094324903`*^9}, {
   3.517569340521036*^9, 3.517569351999188*^9}, {3.5175694399560623`*^9, 
   3.517569505622246*^9}, 3.517569538161134*^9, {3.5175696562194777`*^9, 
   3.517569755571988*^9}, {3.5175697997450047`*^9, 3.5175698704559298`*^9}, {
   3.517569934293189*^9, 3.517570006484476*^9}, {3.5175700385253267`*^9, 
   3.5175700393071747`*^9}, {3.517570070086597*^9, 3.517570237683813*^9}, {
   3.517570317960154*^9, 3.517570450918076*^9}, {3.51757061765029*^9, 
   3.517570700611058*^9}, {3.5175707325938473`*^9, 3.517570737190051*^9}, {
   3.517570840356758*^9, 3.5175709456306*^9}, 3.517570992849962*^9, {
   3.5175710444300013`*^9, 3.517571061782164*^9}, {3.5175710945146637`*^9, 
   3.517571095041098*^9}, {3.517583438823792*^9, 3.517583464524324*^9}, {
   3.517583496846157*^9, 3.517583573208202*^9}, {3.517583608058123*^9, 
   3.517583636840406*^9}, {3.517584647636262*^9, 3.517584648148426*^9}, {
   3.517586191837016*^9, 3.517586195341257*^9}, {3.51758637587267*^9, 
   3.5175864335929947`*^9}, {3.517586478369893*^9, 3.517586689281197*^9}, {
   3.51758674967887*^9, 3.517586758694475*^9}, {3.517586797703703*^9, 
   3.517586852590114*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ids", "=", 
   RowBox[{"traceBackIds", "[", 
    RowBox[{"99999", ",", "genomes"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5175695079221983`*^9, 3.517569556423106*^9}, {
   3.5175702748877687`*^9, 3.517570277151155*^9}, {3.517570308661105*^9, 
   3.517570310884678*^9}, {3.51757046241422*^9, 3.517570464099306*^9}, {
   3.5175707945762253`*^9, 3.517570795456111*^9}, 3.517571102657462*^9, {
   3.517571190898738*^9, 3.517571194568458*^9}, {3.517583478594105*^9, 
   3.517583479402132*^9}, 3.517583515099278*^9, 3.5175836599036217`*^9, {
   3.5175891208451643`*^9, 3.517589121539469*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ids", "//", "MatrixForm"}], ";"}]], "Input",
 CellChangeTimes->{{3.517584103774461*^9, 3.517584108306735*^9}, 
   3.517585497513356*^9, 3.517586837515752*^9, {3.517586883416004*^9, 
   3.517586907048356*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"removeDuplicit", "[", "ids_", "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"l", "=", 
       RowBox[{"{", "}"}]}], ",", "it"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"it", "=", 
      RowBox[{"ids", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "2"}], ",", 
       RowBox[{"i", "<=", 
        RowBox[{"Length", "[", "ids", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
           RowBox[{"all", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", "\"\< \>\"", ",", 
           RowBox[{"all", "\[LeftDoubleBracket]", 
            RowBox[{
             RowBox[{"i", "-", "1"}], ",", "2"}], "\[RightDoubleBracket]"}]}],
           "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ids", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "3"}], "\[RightDoubleBracket]"}], "=!=", 
          RowBox[{"ids", "\[LeftDoubleBracket]", 
           RowBox[{
            RowBox[{"i", "-", "1"}], ",", "3"}], "\[RightDoubleBracket]"}]}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"AppendTo", "[", 
           RowBox[{"l", ",", "it"}], "]"}], ";", 
          RowBox[{"it", "=", 
           RowBox[{
           "ids", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}]}], 
         ",", " ", "\[IndentingNewLine]", "Null"}], "\[IndentingNewLine]", 
        "]"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"l", ",", "it"}], "]"}], ";", "\[IndentingNewLine]", "l"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.517571166638701*^9, 3.517571300846211*^9}, {
  3.5175713369825897`*^9, 3.517571337903174*^9}, {3.517571388112116*^9, 
  3.51757146739636*^9}, {3.517571742186132*^9, 3.517571857989665*^9}, {
  3.517571994817977*^9, 3.5175720269045267`*^9}, {3.517572435603209*^9, 
  3.51757254410367*^9}, {3.517572598266101*^9, 3.517572698326954*^9}, {
  3.517572758234988*^9, 3.517572773235588*^9}, {3.517572839304645*^9, 
  3.517572970498878*^9}, {3.517573069825281*^9, 3.517573074959889*^9}, {
  3.517583667867319*^9, 3.517583697588396*^9}, {3.517583836659546*^9, 
  3.517583872060499*^9}, {3.517584179491056*^9, 3.517584191698748*^9}, {
  3.51758805512994*^9, 3.517588057577474*^9}, {3.5175880900363693`*^9, 
  3.517588103081686*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"removeDuplicit", "[", "ids", "]"}], "//", "MatrixForm"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.517571779433305*^9, 3.517571786584046*^9}, {
   3.517571895895999*^9, 3.517571898207158*^9}, {3.517572032078513*^9, 
   3.5175720332227373`*^9}, {3.517572370058807*^9, 3.517572404685329*^9}, {
   3.517572729430294*^9, 3.517572732277617*^9}, {3.517573142110362*^9, 
   3.517573144214579*^9}, 3.517587789627427*^9, {3.51758806307775*^9, 
   3.517588063229968*^9}, 3.51758810867257*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"onlyNBiggestChanges", "[", 
   RowBox[{"ids_", ",", "N_"}], "]"}], ":=", 
  RowBox[{"ids", "\[LeftDoubleBracket]", 
   RowBox[{"Sort", "[", 
    RowBox[{"Ordering", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
           "-", 
          RowBox[{
          "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
         "]"}], "&"}], "/@", 
       RowBox[{"Partition", "[", 
        RowBox[{
         RowBox[{"ids", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "4"}], "\[RightDoubleBracket]"}], ",", "2", ",",
          "1"}], "]"}]}], ",", 
      RowBox[{"-", "N"}]}], "]"}], "]"}], 
   "\[RightDoubleBracket]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.517588679606718*^9, 3.5175887535523357`*^9}, {
  3.5175887918013153`*^9, 3.51758886201329*^9}, {3.517588952488565*^9, 
  3.517588966989357*^9}, {3.517589186239523*^9, 3.517589202262884*^9}, {
  3.5175892791086206`*^9, 3.517589279826384*^9}, {3.5175893184013*^9, 
  3.517589354080799*^9}, {3.517589395711218*^9, 3.517589432648056*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"listBSFEvolution", "[", "fileName_", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "genomes", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"genomes", "=", 
      RowBox[{"ToExpression", "@", 
       RowBox[{"StringSplit", "[", 
        RowBox[{
         RowBox[{"Import", "[", "fileName", "]"}], ",", "\"\<\\n\>\""}], 
        "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"onlyNBiggestChanges", "[", 
      RowBox[{
       RowBox[{"traceBackIds", "[", 
        RowBox[{
         RowBox[{"findBSFId", "[", "genomes", "]"}], ",", "genomes"}], "]"}], 
       ",", "5"}], "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"removeDuplicit", "[", 
     RowBox[{"traceBackIds", "[", 
      RowBox[{
       RowBox[{"findBSFId", "[", "genomes", "]"}], ",", "genomes"}], "]"}], 
     "]"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"traceBackIds", "[", 
     RowBox[{
      RowBox[{"findBSFId", "[", "genomes", "]"}], ",", "genomes"}], "]"}], 
    "*)"}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.517587811333811*^9, 3.5175879102779818`*^9}, {
   3.517588015598867*^9, 3.517588019149382*^9}, {3.5175880820241528`*^9, 
   3.51758808436727*^9}, {3.5175881238900633`*^9, 3.517588129920392*^9}, {
   3.5175881923782263`*^9, 3.517588203161255*^9}, {3.517588252229972*^9, 
   3.5175882611079063`*^9}, {3.517589448554031*^9, 3.517589474722691*^9}, 
   3.517590658992374*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
  "listBSFEvolution", "[", 
   "\"\<~/java/exp/GP_T/run_001_010_O_GENOMES_MATH.txt\>\"", "]"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.517588023561946*^9, 3.517588036503592*^9}, {
  3.517588151136188*^9, 3.517588153456147*^9}, {3.51758965548825*^9, 
  3.517589655597713*^9}, {3.517589847597481*^9, 3.517589867028872*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"900276", "900170", 
      RowBox[{"{", 
       RowBox[{"times", "[", 
        RowBox[{
         RowBox[{"gauss", "[", 
          RowBox[{"-", "1.`"}], "]"}], ",", "x1"}], "]"}], "}"}], 
      "61.888678092343845`"},
     {"900858", "900710", 
      RowBox[{"{", 
       RowBox[{"times", "[", 
        RowBox[{
         RowBox[{"gauss", "[", 
          RowBox[{"times", "[", 
           RowBox[{"x3", ",", 
            RowBox[{"times", "[", 
             RowBox[{
              RowBox[{"atan", "[", "x0", "]"}], ",", 
              RowBox[{"sin", "[", "x2", "]"}]}], "]"}]}], "]"}], "]"}], ",", 
         "x1"}], "]"}], "}"}], "62.65499227421364`"},
     {"901330", "900992", 
      RowBox[{"{", 
       RowBox[{"times", "[", 
        RowBox[{
         RowBox[{"gauss", "[", "x3", "]"}], ",", 
         RowBox[{"times", "[", 
          RowBox[{"x1", ",", 
           RowBox[{"atan", "[", "2.2402137742751935`", "]"}]}], "]"}]}], 
        "]"}], "}"}], "71.00204761516957`"},
     {"904491", "904314", 
      RowBox[{"{", 
       RowBox[{"times", "[", 
        RowBox[{
         RowBox[{"gauss", "[", "x2", "]"}], ",", 
         RowBox[{"times", "[", 
          RowBox[{"x1", ",", "1.3850241552438134`"}], "]"}]}], "]"}], "}"}], 
      "74.59242498015503`"},
     {"908626", "908227", 
      RowBox[{"{", 
       RowBox[{"times", "[", 
        RowBox[{
         RowBox[{"gauss", "[", "x2", "]"}], ",", 
         RowBox[{"times", "[", 
          RowBox[{
           RowBox[{"times", "[", 
            RowBox[{
             RowBox[{"gauss", "[", "x3", "]"}], ",", "x1"}], "]"}], ",", 
           "1.5077438621997405`"}], "]"}]}], "]"}], "}"}], "85.5807297805739`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.517588043627275*^9, {3.51758813796463*^9, 3.517588160207119*^9}, 
   3.517588211744544*^9, 3.517588269062258*^9, 3.517589484311322*^9, 
   3.5175896630168657`*^9, {3.517589851393826*^9, 3.51758987290722*^9}, 
   3.517590489615149*^9, 3.517590668815893*^9}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1496, 923},
WindowMargins->{{1, Automatic}, {Automatic, 0}},
FrontEndVersion->"8.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (February 23, \
2011)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 96, 1, 67, "Section"],
Cell[678, 25, 500, 11, 27, "Input"],
Cell[1181, 38, 169, 4, 26, "Text"],
Cell[CellGroupData[{
Cell[1375, 46, 423, 14, 27, "Input"],
Cell[1801, 62, 332, 8, 27, "Output"]
}, Open  ]],
Cell[2148, 73, 761, 18, 27, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[2934, 95, 134, 2, 27, "Input"],
Cell[3071, 99, 173, 2, 27, "Output"]
}, Open  ]],
Cell[3259, 104, 2828, 61, 148, "Input",
 InitializationCell->True],
Cell[6090, 167, 631, 11, 27, "Input"],
Cell[6724, 180, 243, 5, 27, "Input"],
Cell[6970, 187, 2762, 61, 208, "Input",
 InitializationCell->True],
Cell[9735, 250, 530, 10, 27, "Input"],
Cell[10268, 262, 1196, 29, 27, "Input",
 InitializationCell->True],
Cell[11467, 293, 1525, 36, 118, "Input"],
Cell[CellGroupData[{
Cell[13017, 333, 374, 8, 27, "Input"],
Cell[13394, 343, 2501, 67, 105, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
